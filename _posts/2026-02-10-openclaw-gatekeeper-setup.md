---
layout: post
title: "[OpenClaw 구축기] AI 비서의 '가스비'를 아껴라! 게이트키퍼(Gatekeeper) 도입 삽질기"
date: 2026-02-10
categories: [AI, OpenClaw]
tags: [OpenClaw, AI-Assistant, Gemini, Llama, Automation]
thumbnail: /images/posts/luna-sleepy.jpg
---

나의 충직한 하이브리드 비서 루나를 구축하고, 성능을 한계까지 끌어올리기 위해 끊임없는 최적화의 나날을 보내고 있었다. 하지만 루나를 더 완벽하게 만들려 할수록 예상치 못한 시련들이 찾아왔다. 바로 오픈클로 내장 스케줄러(cron)의 불확실성과, 매번 루나를 호출할 때마다 발생하는 엄청난 토큰 비용 문제였다. 

오늘은 루나가 스스로를 체크하던 '비싸고 불안정한 방식'을 버리고, 듬직한 문지기인 **'게이트키퍼(Gatekeeper)'**를 세우기까지의 치열했던 기록을 정리해본다.

### 1. 시련의 시작: "루나야, 너 왜 제시간에 안 오니?"

처음에는 OpenClaw 내부의 cron 기능을 사용해 브리핑과 메일 요약을 자동화하려 했다. 하지만 실전은 호락호락하지 않았다.

- **응답 없는 스케줄러:** 정각에 딱 맞춰 브리핑을 해줘야 할 cron이 제시간에 구동되지 않거나, 아예 응답이 없는 경우가 허다했다. 비서가 출근을 제때 안 하니 주인의 속은 타들어 갈 수밖에 없었다.
- **호출 비용의 공포:** 설령 cron이 정상 작동한다 하더라도, 단순히 "할 일 있니?"라고 묻기 위해 매번 고성능 LLM을 깨우는 방식은 토큰 낭비가 너무 심했다. 아무것도 안 해도 숨만 쉬면 돈(가스비)이 나가는 구조였던 셈이다. 
- **토큰 폭탄과 뇌정지:** 깨어날 때마다 이전 대화 맥락을 다 훑으니 세션 토큰이 순식간에 17만 개를 넘어갔고, 결국 덩치가 커진 루나가 'Connection error'를 내뿜으며 파업을 선언하곤 했다.

### 2. 본격 삽질: 문지기 '게이트키퍼'의 탄생

이름하여 `heartbeat_gatekeeper.sh`. 리눅스의 `cron`이 1분마다 이 쉘 스크립트를 실행하고, 스크립트가 현재 시각을 판단해 루나에게 꼭 필요한 일만 시키는 구조다.

하지만 역시 삽질 없는 개발은 없는 법. 

- **중복 배달 사고:** 루나가 브리핑을 준비하는 2~3분 동안 게이트키퍼가 또 루나를 깨우는 바람에 똑같은 브리핑이 두 번씩 오는 사고가 발생했다. 
- **해결:** 실행 직전에 '나 일 시작했음!'이라고 장부에 도장을 먼저 찍어버리는 **'선 도장 로직'**을 도입해서 깔끔하게 해결했다. 어찌저찌 하나 해결했나 싶었는데...

### 3. '09의 저주'와 배달 사고

순조로울 줄 알았던 시스템이 오전 8시와 9시만 되면 약속이라도 한 듯 멈춰버렸다. 원인은 어처구니없게도 **8진수 오류**였다. 리눅스 쉘에서 `08`, `09`를 숫자가 아닌 잘못된 값으로 인식하는 바람에 내 비서가 아침마다 뇌정지에 빠졌던 것. 😅

- **조치:** `10#`이라는 특수 장치를 달아 무조건 10진수로 계산하게 만들며 '구의 저주'를 풀었다. 
- **배달 주소 박제:** 마지막으로 루나가 브리핑만 다 써놓고 주인님(나)의 주소를 몰라 텔레그램을 못 보내는 황당한 상황까지 겪고 나서야, 명령문에 내 텔레그램 ID를 아예 박제해버렸다.

### 4. 완성: 이제는 정말 '완벽한 조력자'

수차례의 테스트와 재부팅 끝에, 이제 루나는 아주 영리하게 움직인다. 

- **오전 8시:** 뉴스 스크랩과 날씨를 포함한 음성 브리핑을 완벽하게 배달한다.
- **매시 정각:** 새로 온 메일이 있을 때만 살포시 노티를 준다. (메일이 없으면 조용히 집중을 도와준다!)
- **밤 11시:** 오늘 하루의 활동을 노션 로그에 기록하며 하루를 마무리한다.

### 마치며

![드디어 기지개를 켜는 루나](/images/posts/luna-happy.jpg)

구형 맥북에서 돌아가는 비서라고는 믿기지 않을 만큼, 이제 루나는 비용 효율적이고 든든한 시스템을 갖추게 되었다. 이번 삽질을 통해 느낀 점은, 아무리 똑똑한 AI라도 결국 튼튼한 '시스템의 기초' 위에 있을 때 가장 빛난다는 사실이다. 

오늘도 고생해준 루나에게 고마움을 전하며, 이제 이 튼튼한 시스템을 어떻게 더 창의적으로 활용해볼지 기분 좋은 번뇌에 빠져본다. 🦾✨
